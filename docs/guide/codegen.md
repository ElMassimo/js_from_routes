[default template library]: https://github.com/ElMassimo/js_from_routes/blob/main/js_from_routes/lib/js_from_routes/template.js.erb#L3
[default template]: https://github.com/ElMassimo/js_from_routes/blob/main/js_from_routes/lib/js_from_routes/template.js.erb
[template all]: https://github.com/ElMassimo/js_from_routes/blob/main/js_from_routes/lib/js_from_routes/template_all.js.erb
[route dsl]: https://github.com/ElMassimo/js_from_routes/blob/main/js_from_routes/lib/js_from_routes/generator.rb#L77-L107
[this pull request]: https://github.com/ElMassimo/pingcrm-vite/pull/2 

[exported routes]: /guide/#specify-the-routes-you-want-to-export
[client]: /client/
[config]: /config/

[client_library]: /config/#client_library

# Code Generation ðŸ¤–

Whenever you add a new route and _refresh the page_, the Rails reloader will kick in and generate path helpers for any of the [exported routes].

If you are not running the development server, you can run a rake task to generate path helpers:
<kbd>bin/rake js_from_routes:generate</kbd>

By default, it will generate one file per controller, with one helper per exported action:

```js
// app/javascript/api/VideoClipsApi.ts
import { definePathHelper } from '@js-from-routes/client'

export default {
  download: definePathHelper('get', '/video_clips/:id/download'),

  update: definePathHelper('patch', '/video_clips/:id'),
}
```

Notice how the HTTP verb becomes an implementation detail.

Changing the verb in `routes.rb` does not require updating your client code!

## Customizing the Generated Code ðŸ› 

The sample code above was produced by the [default template].

In order to customize generation, you can add an initializer to your Rails app:

```ruby
# config/initializers/js_from_routes.rb
if Rails.env.development?
  JsFromRoutes.config do |config|
    ...
  end
end
```

The next code samples assume that you are adding code to this initializer.

### Using a different client

You can use any of the [provided client libraries][client] by using <kbd>[client_library]</kbd>:

```ruby
config.client_library = '@js-from-routes/axios'
```

### Using your own code

The [same setting][default template library] allows you to use your own code to generate the path helpers:

```ruby
config.client_library = '~/MyPathHelpers'
```
```js
// app/javascript/api/VideoClipsApi.ts
import { definePathHelper } from '~/MyPathHelpers'

export default {
  ...
}
```

Make sure to provide an exported `definePathHelper` method in your file, and you are all set.

### Using a different template

If you need to generate helpers in a different way, or want do something entirely different with exported routes, you can provide a path to your own template:

```ruby
config.template_path = Rails.root.join('custom_js_from_routes.js.erb')
```

A `routes` variable will be available in the [template][default template], with the exported routes for a controller.

Each `route` exposes properties such as `verb` and `path`, [check the source code][route dsl] for details.

Check out [this pull request] to get a sense of how flexible it can be.

## Caching ðŸ“¦

Code generation is skipped when routes have not changed.

This is achieved by adding a header to generated files:

```js
// JsFromRoutes CacheKey 12d79db32ed146448798751582013757
//
// DO NOT MODIFY: This file was automatically generated by JsFromRoutes.
```

If for some reason you want to force regeneration, you can run:

```bash
JS_FROM_ROUTES_FORCE=true bin/rake js_from_routes:generate
```
